#!/bin/sh# usage: dcunjpeg infile outfile## only works for 16 not 8 bits due to hardwired OWTMPROOT=/tmp/`basename $0`.$$ANCREATE=ancreateDCCP=dccpDCDUMP=dcdumpDCTORAW=dctorawJPEG=jpegbitsallocatedhex=`dckey -k BitsAllocated "$1" 2>&1`bitsallocatedhigh=`echo "$bitsallocatedhex" | sed -e 's/0[xX][0-9aAbBcCdDeEfF]*\([0-9aAbBcCdDeEfF]\)[0-9aAbBcCdDeEfF]$/\1/' | sed -e 's/[aA]/10/' -e 's/[bB]/11/' -e 's/[cC]/12/' -e 's/[dD]/13/' -e 's/[eE]/14/' -e 's/[fF]/15/'`bitsallocatedlow=`echo "$bitsallocatedhex" | sed -e 's/0[xX][0-9aAbBcCdDeEfF]*\([0-9aAbBcCdDeEfF]\)$/\1/' | sed -e 's/[aA]/10/' -e 's/[bB]/11/' -e 's/[cC]/12/' -e 's/[dD]/13/' -e 's/[eE]/14/' -e 's/[fF]/15/'`bitsallocated=`expr "$bitsallocatedhigh" '*' 16 + "$bitsallocatedlow"`if [ "$bitsallocated" -le 8 ]then	oborowsed='s/VR=<O[BW]>/VR=<OB>/'else	oborowsed='s/VR=<O[BW]>/VR=<OW>/'fi$DCDUMP $1 2>&1 | grep '10) OX Pixel Data' | sed -e 's/$/ []/' -e "$oborowsed" | $ANCREATE -e > $TMPROOT.pixelhead$DCTORAW -quiet $1 $TMPROOT.jpg$JPEG -d $TMPROOTdd if=$TMPROOT of=$TMPROOT.raw.littleendian conv=swab$DCCP $1 $TMPROOT.nopixels -d PixelDatacat $TMPROOT.nopixels $TMPROOT.pixelhead $TMPROOT.raw.littleendian > $2rm -f $TMPROOT*exit 0